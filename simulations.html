<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>master thesis template</title>
  <meta name="description" content="Generalized linear mixed models, MCMC algorithms, Spatial generalized linear mixed models, Stan platform.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="master thesis template" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/logo.png" />
  <meta property="og:description" content="Generalized linear mixed models, MCMC algorithms, Spatial generalized linear mixed models, Stan platform." />
  <meta name="github-repo" content="XiangyunHuang/Thesis-Template-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="master thesis template" />
  
  <meta name="twitter:description" content="Generalized linear mixed models, MCMC algorithms, Spatial generalized linear mixed models, Stan platform." />
  <meta name="twitter:image" content="images/logo.png" />

<meta name="author" content="Xiang-Yun Huang">


<meta name="date" content="2018-09-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
<link rel="prev" href="algorithms.html">
<link rel="next" href="applications.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">空间广义线性混合效应模型及其应用</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 绪论</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivations"><i class="fa fa-check"></i><b>1.1</b> 研究意义</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#reviews"><i class="fa fa-check"></i><b>1.2</b> 文献综述</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#stracture"><i class="fa fa-check"></i><b>1.3</b> 论文结构</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#Conventions-Colophon"><i class="fa fa-check"></i><b>1.4</b> 符号说明</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prepare.html"><a href="prepare.html"><i class="fa fa-check"></i><b>2</b> 基础知识</a><ul>
<li class="chapter" data-level="2.1" data-path="prepare.html"><a href="prepare.html#sec:exp"><i class="fa fa-check"></i><b>2.1</b> 指数族</a></li>
<li class="chapter" data-level="2.2" data-path="prepare.html"><a href="prepare.html#lse"><i class="fa fa-check"></i><b>2.2</b> 最小二乘估计</a></li>
<li class="chapter" data-level="2.3" data-path="prepare.html"><a href="prepare.html#def-mle"><i class="fa fa-check"></i><b>2.3</b> 极大似然估计</a></li>
<li class="chapter" data-level="2.4" data-path="prepare.html"><a href="prepare.html#section-2.4"><i class="fa fa-check"></i><b>2.4</b> 随机过程的连续性和可微性</a></li>
<li class="chapter" data-level="2.5" data-path="prepare.html"><a href="prepare.html#stationary-gaussian-process"><i class="fa fa-check"></i><b>2.5</b> 平稳高斯过程</a></li>
<li class="chapter" data-level="2.6" data-path="prepare.html"><a href="prepare.html#Modified-Bessel-functions"><i class="fa fa-check"></i><b>2.6</b> 修正的第三类贝塞尔函数</a></li>
<li class="chapter" data-level="2.7" data-path="prepare.html"><a href="prepare.html#Laplace-approximation"><i class="fa fa-check"></i><b>2.7</b> 拉普拉斯近似</a></li>
<li class="chapter" data-level="2.8" data-path="prepare.html"><a href="prepare.html#Jeffreys-prior"><i class="fa fa-check"></i><b>2.8</b> Jeffreys 先验分布</a></li>
<li class="chapter" data-level="2.9" data-path="prepare.html"><a href="prepare.html#bayes-methods"><i class="fa fa-check"></i><b>2.9</b> 贝叶斯理论</a></li>
<li class="chapter" data-level="2.10" data-path="prepare.html"><a href="prepare.html#bayesian-data-analysis"><i class="fa fa-check"></i><b>2.10</b> 贝叶斯数据分析</a></li>
<li class="chapter" data-level="2.11" data-path="prepare.html"><a href="prepare.html#Curse-of-Dimensionality"><i class="fa fa-check"></i><b>2.11</b> 维数灾难与蒙特卡罗积分</a></li>
<li class="chapter" data-level="2.12" data-path="prepare.html"><a href="prepare.html#Samplers"><i class="fa fa-check"></i><b>2.12</b> 采样器与 Stan</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>3</b> 统计模型</a><ul>
<li class="chapter" data-level="3.1" data-path="models.html"><a href="models.html#Linear-Models"><i class="fa fa-check"></i><b>3.1</b> 线性模型</a></li>
<li class="chapter" data-level="3.2" data-path="models.html"><a href="models.html#Generalized-Linear-Models"><i class="fa fa-check"></i><b>3.2</b> 广义线性模型</a></li>
<li class="chapter" data-level="3.3" data-path="models.html"><a href="models.html#Linear-Mixed-Effects-Models"><i class="fa fa-check"></i><b>3.3</b> 线性混合效应模型</a></li>
<li class="chapter" data-level="3.4" data-path="models.html"><a href="models.html#Generalized-Linear-Mixed-Effects-Models"><i class="fa fa-check"></i><b>3.4</b> 广义线性混合效应模型</a></li>
<li class="chapter" data-level="3.5" data-path="models.html"><a href="models.html#section-3.5"><i class="fa fa-check"></i><b>3.5</b> 空间线性混合效应模型</a></li>
<li class="chapter" data-level="3.6" data-path="models.html"><a href="models.html#Spatial-Generalized-linear-mixed-effects-models"><i class="fa fa-check"></i><b>3.6</b> 空间广义线性混合效应模型</a><ul>
<li class="chapter" data-level="3.6.1" data-path="models.html"><a href="models.html#intro-sglmm"><i class="fa fa-check"></i><b>3.6.1</b> 模型结构</a></li>
<li class="chapter" data-level="3.6.2" data-path="models.html"><a href="models.html#covariance-function"><i class="fa fa-check"></i><b>3.6.2</b> 协方差函数</a></li>
<li class="chapter" data-level="3.6.3" data-path="models.html"><a href="models.html#identify"><i class="fa fa-check"></i><b>3.6.3</b> 模型识别</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a><ul>
<li class="chapter" data-level="4.1" data-path="algorithms.html"><a href="algorithms.html#mle"><i class="fa fa-check"></i><b>4.1</b> 极大似然估计</a></li>
<li class="chapter" data-level="4.2" data-path="algorithms.html"><a href="algorithms.html#profile-likelihood"><i class="fa fa-check"></i><b>4.2</b> 剖面似然估计</a></li>
<li class="chapter" data-level="4.3" data-path="algorithms.html"><a href="algorithms.html#maximum-likelihood-estimates"><i class="fa fa-check"></i><b>4.3</b> 极大似然估计</a></li>
<li class="chapter" data-level="4.4" data-path="algorithms.html"><a href="algorithms.html#algrithms"><i class="fa fa-check"></i><b>4.4</b> 参数估计的算法</a><ul>
<li class="chapter" data-level="4.4.1" data-path="algorithms.html"><a href="algorithms.html#LA"><i class="fa fa-check"></i><b>4.4.1</b> 拉普拉斯近似算法</a></li>
<li class="chapter" data-level="4.4.2" data-path="algorithms.html"><a href="algorithms.html#MCML"><i class="fa fa-check"></i><b>4.4.2</b> 蒙特卡罗极大似然算法</a></li>
<li class="chapter" data-level="4.4.3" data-path="algorithms.html"><a href="algorithms.html#MCMC"><i class="fa fa-check"></i><b>4.4.3</b> 贝叶斯 MCMC 算法</a></li>
<li class="chapter" data-level="4.4.4" data-path="algorithms.html"><a href="algorithms.html#LowRank"><i class="fa fa-check"></i><b>4.4.4</b> 低秩近似算法</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="algorithms.html"><a href="algorithms.html#STAN-MCMC"><i class="fa fa-check"></i><b>4.5</b> 贝叶斯 STAN-MCMC 算法</a><ul>
<li class="chapter" data-level="4.5.1" data-path="algorithms.html"><a href="algorithms.html#section-4.5.1"><i class="fa fa-check"></i><b>4.5.1</b> 算法提出的背景和意义</a></li>
<li class="chapter" data-level="4.5.2" data-path="algorithms.html"><a href="algorithms.html#STANMCMC"><i class="fa fa-check"></i><b>4.5.2</b> STAN-MCMC 算法实现过程</a></li>
<li class="chapter" data-level="4.5.3" data-path="algorithms.html"><a href="algorithms.html#-r-"><i class="fa fa-check"></i><b>4.5.3</b> 求解模型的 R 包</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>5</b> 数值模拟</a><ul>
<li class="chapter" data-level="5.1" data-path="simulations.html"><a href="simulations.html#section-5.1"><i class="fa fa-check"></i><b>5.1</b> 一维空间高斯过程</a></li>
<li class="chapter" data-level="5.2" data-path="simulations.html"><a href="simulations.html#sim-gp"><i class="fa fa-check"></i><b>5.2</b> 平稳空间高斯过程</a></li>
<li class="chapter" data-level="5.3" data-path="simulations.html"><a href="simulations.html#sim-sglmm"><i class="fa fa-check"></i><b>5.3</b> 空间广义线性混合效应模型</a><ul>
<li class="chapter" data-level="5.3.1" data-path="simulations.html"><a href="simulations.html#binomal-sglmm"><i class="fa fa-check"></i><b>5.3.1</b> 响应变量服从二项分布</a></li>
<li class="chapter" data-level="5.3.2" data-path="simulations.html"><a href="simulations.html#possion-sglmm"><i class="fa fa-check"></i><b>5.3.2</b> 响应变量服从泊松分布</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>6</b> 数据分析</a><ul>
<li class="chapter" data-level="6.1" data-path="applications.html"><a href="applications.html#sptial-random-effects"><i class="fa fa-check"></i><b>6.1</b> 空间线性混合效应模型</a></li>
<li class="chapter" data-level="6.2" data-path="applications.html"><a href="applications.html#loaloa"><i class="fa fa-check"></i><b>6.2</b> 喀麦隆及周边地区盘尾丝虫病的空间分布</a></li>
<li class="chapter" data-level="6.3" data-path="applications.html"><a href="applications.html#rongelap"><i class="fa fa-check"></i><b>6.3</b> 朗格拉普岛放射性残留物的空间分布</a></li>
<li class="chapter" data-level="6.4" data-path="applications.html"><a href="applications.html#section-6.4"><i class="fa fa-check"></i><b>6.4</b> 冈比亚儿童疟疾流行强度的空间分布</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>7</b> 总结展望</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>附录</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#sessioninfo"><i class="fa fa-check"></i>软件信息</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#random-number-generation"><i class="fa fa-check"></i>随机数生成</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#compare-algrithms"><i class="fa fa-check"></i>算法比较</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">master thesis template</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulations" class="section level1">
<h1><span class="header-section-number">第 5 章</span> 数值模拟</h1>
<p>空间广义线性混合效应模型（以下简称 SGLMM 模型）在广义线性混合效应模型（以下简称 GLMM 模型）基础上添加了与空间位置相关的随机效应，这种随机效应在文中称为空间效应 <span class="citation">(Diggle, Tawn, and Moyeed <a href="#ref-Diggle1998">1998</a>)</span>。 它与采样点的位置、数量有关，采样点的位置决定空间过程的协方差结构， 而采样点的数量决定空间效应的维度，从而导致 SGLMM 模型比一般的 GLMM 模型复杂。作为过渡，我们在第 <a href="simulations.html#sim-gp">5.2</a> 节模拟了平稳高斯过程。 第 <a href="simulations.html#sim-sglmm">5.3</a> 节模拟 SGLMM 模型， 分两个小节展开叙述，第 <a href="simulations.html#binomal-sglmm">5.3.1</a> 小节模拟响应变量服从二项分布的情形， 第 <a href="simulations.html#possion-sglmm">5.3.2</a> 小节模拟响应变量服从泊松分布的情形， 在这两个小节里， 比较了蒙特卡罗极大似然算法（Monte Carlo Maximum Likelihood，简称 MCML）， 低秩近似算法（以下简称 Low-Rank 算法）， 贝叶斯马尔科夫链蒙特卡罗算法（以下简称贝叶斯 MCMC 算法）和 贝叶斯 STAN-MCMC 算法的性能差异。</p>
<p>后面每个模型及参数设置都要详细说明，包括模拟过程要对应到前面的算法步骤，分不同的样本量n=50,70,90和参数设置<span class="math inline">\(\phi,\sigma^2,\tau^2\)</span>取不同的值做模拟，</p>
<p>|<span class="math inline">\(\hat\beta_0(std,rmse)\)</span>| 一个位置有三个值，估计值、对应的标准差和均方误差，好好思考下大表格要怎么放，markdown语法下的表格怎么做，|<span class="math inline">\(\hat\phi(std,rmse)\)</span>,<span class="math inline">\(\hat\sigma^2(std,rmse)\)</span>|</p>
<p>模拟空间广义线性混合效应模型 <a href="simulations.html#eq:sim-sglmm">(5.1)</a> 分三节进行，第一节模拟空间高斯过程 <span class="math inline">\(S(x)\)</span>，第二节模拟响应变量 <span class="math inline">\(Y\)</span> 服从二项分布 ，第三节模拟响应变量 <span class="math inline">\(Y\)</span> 服从正态分布。空间高斯过程在模型 <a href="simulations.html#eq:sim-sglmm">(5.1)</a> 中作为随机效应存在，不同于一般随机效应的地方在于它与样本的空间位置有关，一般地，假定 <span class="math inline">\(S(x)\)</span> 服从 <span class="math inline">\(N\)</span> 元高斯分布 <span class="math inline">\(N(\mu_{S},G)\)</span>，<span class="math inline">\(x = (d_1,d_2) \in \mathbb{R}^2\)</span>， <span class="math inline">\(\mu_{S} = \mathbf{0}_{N\times1}\)</span>， <span class="math inline">\(G_{(ij)} = \mathrm{Cov}(S(x_i),S(x_j))=\sigma^2*\rho(u_{ij})\)</span>， <span class="math inline">\(S(x)\)</span> 的相关函数 <span class="math inline">\(\rho(u_{ij}) = \exp(-u_{ij}/\phi), u_{ij} \equiv \|x_{i}-x_{j}\|_2\)</span>，其中 <span class="math inline">\(\phi\)</span> 和 <span class="math inline">\(\sigma^2\)</span> 都是未知待估参数。可见
采样点的位置 <span class="math inline">\((d_1,d_2)\)</span> 和相关函数 <span class="math inline">\(\rho(u)\)</span> 一起决定空间高斯过程的形式，并且 <span class="math inline">\(S(x)\)</span> 的维度就是采样点的数目 <span class="math inline">\(N\)</span>。这样通常导致空间效应的维度比协变量的数目大很多，模型 <a href="simulations.html#eq:sim-sglmm">(5.1)</a> 的估计问题也比一般的广义线性混合效应模型困难。</p>
<p><span class="math display" id="eq:sim-sglmm">\[\begin{equation}
g(\mu_i) = d(x_i)&#39;\beta + S(x_i) + Z_i \tag{5.1}
\end{equation}\]</span></p>
<div id="section-5.1" class="section level2">
<h2><span class="header-section-number">5.1</span> 一维空间高斯过程</h2>
<p>一维</p>
</div>
<div id="sim-gp" class="section level2">
<h2><span class="header-section-number">5.2</span> 平稳空间高斯过程</h2>
<p>这里，我们在规则平面上模拟平稳高斯过程 <span class="math inline">\(\mathcal{S} = S(x), x \in \mathbb{R}^2\)</span>， 其均值为0， 自协方差函数为</p>
<p><span class="math display" id="eq:exp-quad">\[\begin{equation}
\mathrm{Cov}(S(x_i),S(x_j)) = \sigma^2\exp\big\{-\big( \frac{ \| x_{i} - x_{j} \|_{2}}{\sqrt{2}\phi}\big)^{\kappa}\big\}  \tag{5.2}
\end{equation}\]</span></p>
<p>设置参数 <span class="math inline">\(\kappa = 2,\phi=1,\sigma^2=1\)</span>，单位平面区域为 <span class="math inline">\([0,1]\times[0,1]\)</span>， 将此区域划分为 <span class="math inline">\(7\times 7\)</span> 的小网格，设置每个格点为采样的位置。由自协方差函数 <a href="simulations.html#eq:exp-quad">(5.2)</a> 可以获得 <span class="math inline">\(\mathcal{S}\)</span> 的协方差矩阵，然后使用 R包 <strong>MASS</strong> 提供的 <code>mvrnorm</code> 函数产生多元正态分布随机数。 模拟数据生成的图像见图 <a href="simulations.html#fig:gp">5.1</a>， 格点上的值即为平稳空间高斯过程在该点的取值 （为方便显示，已四舍五入保留两位小数）。</p>
<div class="figure" style="text-align: center"><span id="fig:gp"></span>
<img src="04-simulations_files/figure-html/gp-1.png" alt="平稳空间高斯过程：自相关函数为幂指数族" width="70%" />
<p class="caption">
图 5.1: 平稳空间高斯过程：自相关函数为幂指数族
</p>
</div>
<p>紧接上文，模拟模型当中的空间效应 <span class="math inline">\(S(x)\)</span> ， 其相关函数可以为指数族或者梅隆族，函数形式如公式 <a href="simulations.html#eq:exp-matern">(5.3)</a> 所示，为描述简单起见，以指数族说明。</p>
<p><span class="math display" id="eq:exp-matern">\[\begin{equation}
\rho(u) =
\begin{cases}
\exp(-(u/\phi)^{\kappa}) &amp; \text{指数族}\\
\{2^{\kappa -1}\Gamma(\kappa)\}^{-1}(u/\phi)^{\kappa}\mathcal{K}_{\kappa}(u/\phi) &amp; \text{梅隆族}
\end{cases} \tag{5.3}
\end{equation}\]</span></p>
<p>固定样本量 <span class="math inline">\(n=1600\)</span> ，其它参数为 <span class="math inline">\(\sigma^2=1,\phi=25,\kappa=1\)</span> ，在区域 <span class="math inline">\([-0.2,1.2]\times [-0.2,1.2]\)</span> 上，分别模拟规则网格上的采样和 随机采样，图中 <span class="math inline">\(S(x)\)</span> 的值越大，颜色越红，反之，颜色越蓝。使用R函数 <code>dist</code> 计算样本点之间的距离，用 <code>MASS::mvrnorm</code> 函数生成服从多元高斯分布的随机数。</p>
</div>
<div id="sim-sglmm" class="section level2">
<h2><span class="header-section-number">5.3</span> 空间广义线性混合效应模型</h2>
<p>模拟的空间广义线性混合效应模型是</p>
<p><span class="math display" id="eq:sim-SGLMM">\[\begin{equation}
g(\mu_i) = \beta_{0} + \beta_{1} * X_{1} + \beta_{2} * X_{2} + S(x) \tag{5.4}
\end{equation}\]</span></p>
<p>其中，<span class="math inline">\(\beta_0\)</span> 是截距，<span class="math inline">\(\beta_{1},\beta_{2}\)</span> 是固定效应 <span class="math inline">\(X_{1}\)</span> 和 <span class="math inline">\(X_{2}\)</span> 的系数，<span class="math inline">\(S(x)\)</span> 是平稳空间高斯过程，其均值为0，自协方差函数为 <span class="math inline">\(\mathrm{Cov}(S(x_i),S(x_j)) = \sigma^2 \big\{2^{\kappa-1}\Gamma(\kappa)\big\}^{-1}(u/\phi)^{\kappa}K_{\kappa}(u/\phi)\)</span>，在后续的模拟中 <span class="math inline">\(\kappa = 2\)</span>，<span class="math inline">\(g\)</span> 是联系函数，由响应变量 <span class="math inline">\(Y\)</span> 服从的分布决定，在第 <a href="simulations.html#binomal-sglmm">5.3.1</a> 小节中，<span class="math inline">\(g(\mu_i) = \log\{\frac{p(x_i)}{1-p(x_i)}\}\)</span>，<span class="math inline">\(Y_{i} \sim \mathrm{Binomal}(m_{i},p(x_{i}))\)</span>，在位置 <span class="math inline">\(x_i\)</span> 处，以概率 <span class="math inline">\(p(x_i)\)</span> 重复抽取了 <span class="math inline">\(m_i\)</span> 个样本，总样本数 <span class="math inline">\(M=\sum_{i=1}^{N}m_i\)</span>，<span class="math inline">\(N\)</span> 是采样点的个数，在第 <a href="simulations.html#possion-sglmm">5.3.2</a> 小节中，<span class="math inline">\(Y_i \sim \mathrm{Possion}(\lambda(x_{i}))\)</span>，类似地，<span class="math inline">\(g(\mu_i) = \log\{\lambda(x_{i})\}\)</span>。</p>
<div id="binomal-sglmm" class="section level3">
<h3><span class="header-section-number">5.3.1</span> 响应变量服从二项分布</h3>
<p>响应变量服从二项分布，模型为 <a href="simulations.html#eq:sim-SGLMM">(5.4)</a>， 固定效应参数 <span class="math inline">\(\beta = (\beta_0,\beta_1,\beta_2)\)</span>， 空间效应参数 <span class="math inline">\(\boldsymbol{\theta} = (\sigma^2,\phi)\)</span>。 参数设置为 <span class="math inline">\(\beta = c(-1,1,0.5), \boldsymbol{\theta} = (1,1)\)</span>，采样点数目为 <span class="math inline">\(N=49\)</span>， 每个采样点抽取的样本数 <span class="math inline">\(m_i = 100,i = 1,2,\ldots,N\)</span>，在这组参数下，重复产生 100 个数据集。 分别使用低秩近似算法(LR)， 蒙特卡罗最大似然算法 (MCML)， 贝叶斯 MCMC 算法 (MCMC) 和贝叶斯 STAN-MCMC 算法 (STAN-MCMC) 估计模型的参数。</p>
<table>
<caption><span id="tab:simulation-norm">表 5.1: </span> 正态分布情形下的数值模拟比较</caption>
<thead>
<tr class="header">
<th align="center">参数</th>
<th align="center">真值</th>
<th align="center">估计</th>
<th align="center"></th>
<th align="center"></th>
<th align="center">CPU (s)</th>
<th align="center"></th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\beta_{0}\)</span></td>
<td align="center">1.977</td>
<td align="center">1.016</td>
<td align="center">0.803</td>
<td align="center">21.937</td>
<td align="center">0.857</td>
<td align="center">0.960</td>
<td align="center">298.250</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\beta_{1}\)</span></td>
<td align="center">1.966</td>
<td align="center">1.007</td>
<td align="center">0.796</td>
<td align="center">28.172</td>
<td align="center">1.365</td>
<td align="center">0.516</td>
<td align="center">464.420</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\beta_{2}\)</span></td>
<td align="center">1.958</td>
<td align="center">1.007</td>
<td align="center">0.796</td>
<td align="center">38.114</td>
<td align="center">1.159</td>
<td align="center">0.970</td>
<td align="center">634.720</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\sigma^2\)</span></td>
<td align="center">1.935</td>
<td align="center">1.008</td>
<td align="center">0.796</td>
<td align="center">44.317</td>
<td align="center">3.916</td>
<td align="center">0.264</td>
<td align="center">326.780</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\phi\)</span></td>
<td align="center">1.00</td>
<td align="center">1.05</td>
<td align="center">0.80</td>
<td align="center">0.14</td>
<td align="center">1.68</td>
<td align="center">0.94</td>
<td align="center">238.05</td>
</tr>
</tbody>
</table>
<!-- \begin{table}[!h] -->
<!-- \begin{center} -->
<!-- \caption{ 100个数据集的模拟结果：估计，标准差和估计的均方误差 \label{tab:binomal-LRvsMCML}} -->
<!-- \setlength{\tabcolsep}{2pt} -->
<!-- \vspace{0.1in} -->
<!-- \begin{tabular}{lcccccccccc} -->
<!--  \hline -->
<!--   参数 &  真值 & \multicolumn{3}{c}{LR8$^*$} & \multicolumn{3}{c}{LR16$^*$} &  -->
<!--  \multicolumn{3}{c}{MCML} \\ -->
<!--   \cmidrule(r){3-5}  \cmidrule(r){6-8} \cmidrule(r){9-11} -->
<!--  \noalign{\smallskip}  -->
<!--                 &      & 估计   & 标准差 & 均方误差 & 估计   & 标准差 & 均方误差   & 估计  & 标准差 & 均方误差 \\  -->
<!--    \hline -->
<!--    $\beta_{0}$  & -1.0 & -1.837 & 0.118  &  0.592   & -1.259 & 0.126  & 0.110      & -1.086 & 0.294   &  0.103 \\  -->
<!--    $\beta_{1}$  & 1.0  & 1.143  & 0.071  &  0.133   & 1.291  & 0.073  & 0.063      & 0.989  & 0.072   &  0.049 \\  -->
<!--    $\beta_{2}$  & 0.5  & 0.413  & 0.025  &  0.073   & 0.241  & 0.026  & 0.014      & 0.339  & 0.012   &  0.012 \\  -->
<!--    $\sigma^2$   & 1.0  & 0.528  & 0.177  &  4.060   & 0.499  & 0.090  & 0.060      & 0.268  & 0.405   &  0.013 \\  -->
<!--    $\phi$       & 1.0  & 0.478  & 0.052  &  0.131   & 0.110  & 0.041  & 0.007      & 0.073  & 0.167   &  0.007 \\  -->
<!--    \hline -->
<!--  \end{tabular} -->
<!-- \end{center} -->
<!-- \vspace{0.05in} -->
<!-- * LR8/LR16：低秩近似算法分别使用 $8\times 8$ 和 $16\times 16$ 个采样点， -->
<!-- \end{table} -->
<!-- \begin{table} -->
<!-- \begin{center} -->
<!-- \caption{ 100 个数据集的模拟结果：估计，标准差和估计的均方误差 \label{tab:binomal-MCMCvsSTAN}} -->
<!-- \setlength{\tabcolsep}{2pt} -->
<!-- \vspace{0.1in} -->
<!-- \begin{tabular}{lccccccc} -->
<!--  \hline -->
<!--   参数 &  真值 & \multicolumn{3}{c}{贝叶斯MCMC} & \multicolumn{3}{c}{贝叶斯STAN-MCMC}  \\ -->
<!--   \cmidrule(r){3-5}  \cmidrule(r){6-8}  -->
<!--  \noalign{\smallskip}  -->
<!--                 &     & 估计  & 标准差 & 均方误差 & 估计  & 标准差 & 均方误差 \\  -->
<!--    \hline -->
<!--    $\beta_{0}$  & -1.0 & -1.239 & 0.848 &  0.777   & -1.225 & 0.248  & 0.112      \\  -->
<!--    $\beta_{1}$  & 1.0  & 0.985 & 0.052  &  2.941e-03   & 1.026  & 0.054  & 3.607e-03      \\  -->
<!--    $\beta_{2}$  & 0.5  & 0.519 & 0.019  &  7.422e-04   & 0.503  & 0.016  & 2.649e-04      \\  -->
<!--    $\sigma^2$   & 1.0  & 0.803 & 0.521  &  0.310   & 0.322  & 0.283  & 0.540      \\  -->
<!--    $\phi$       & 1.0  & 0.182 & 0.069  &  0.673   & 0.514  & 0.322  & 0.341      \\  -->
<!--    \hline -->
<!--  \end{tabular} -->
<!-- \end{center} -->
<!-- \end{table} -->
</div>
<div id="possion-sglmm" class="section level3">
<h3><span class="header-section-number">5.3.2</span> 响应变量服从泊松分布</h3>
<p>响应变量服从泊松分布，模型为 <a href="simulations.html#eq:sim-SGLMM">(5.4)</a>，固定效应参数 <span class="math inline">\(\beta = (\beta_0, \beta_1, \beta_2)\)</span>， 空间效应参数 <span class="math inline">\(\boldsymbol{\theta} = (\sigma^2,\phi)\)</span>。 参数设置为 <span class="math inline">\(\beta = c(-1,1,0.5), \boldsymbol{\theta} = (1,1)\)</span>， 采样点数目为 <span class="math inline">\(N=49\)</span>， 每个采样点抽取的样本数 <span class="math inline">\(m_i = 100,i = 1,2,\ldots,N\)</span>，在这组参数下，重复产生 100 个数据集。</p>
<!-- \begin{table} -->
<!-- \begin{center} -->
<!-- \caption{ 100个数据集的模拟结果：估计，标准差和估计的均方误差 \label{tab:possion-LRvsMCML}} -->
<!-- \setlength{\tabcolsep}{2pt} -->
<!-- \vspace{0.1in} -->
<!-- \begin{tabular}{lcccccccccc} -->
<!--  \hline -->
<!--   参数 &  真值 & \multicolumn{3}{c}{LR8} & \multicolumn{3}{c}{LR16} &  -->
<!--  \multicolumn{3}{c}{MCML} \\ -->
<!--   \cmidrule(r){3-5}  \cmidrule(r){6-8} \cmidrule(r){9-11} -->
<!--  \noalign{\smallskip}  -->
<!--                 &     & 估计  & 标准差 & 均方误差 & 估计  & 标准差 & 均方误差 & 估计  & 标准差 & 均方误差 \\  -->
<!--    \hline -->
<!--    $\beta_{0}$  & -1.0 & -1.837 & 0.118  &  0.592   & -1.259 & 0.126  & 0.110      & -1.086 & 0.294   &  0.103 \\  -->
<!--    $\beta_{1}$  & 1.0  & 1.143  & 0.071  &  0.133   & 1.291  & 0.073  & 0.063      & 0.989  & 0.072   &  0.049 \\  -->
<!--    $\beta_{2}$  & 0.5  & 0.413  & 0.025  &  0.073   & 0.241  & 0.026  & 0.014      & 0.339  & 0.012   &  0.012 \\  -->
<!--    $\sigma^2$   & 1.0  & 0.528  & 0.177  &  4.060   & 0.499  & 0.090  & 0.060      & 0.268  & 0.405   &  0.013 \\  -->
<!--    $\phi$       & 1.0  & 0.478  & 0.052  &  0.131   & 0.110  & 0.041  & 0.007      & 0.073  & 0.167   &  0.007 \\  -->
<!--    \hline -->
<!--  \end{tabular} -->
<!-- \end{center} -->
<!-- \end{table} -->
<!-- \begin{table} -->
<!-- \begin{center} -->
<!-- \caption{ 100个数据集的模拟结果：估计，标准差和估计的均方误差 \label{tab:possion-MCMCvsSTAN}} -->
<!-- \setlength{\tabcolsep}{2pt} -->
<!-- \vspace{0.1in} -->
<!-- \begin{tabular}{lccccccc} -->
<!--  \hline -->
<!--   参数 &  真值 & \multicolumn{3}{c}{贝叶斯MCMC} & \multicolumn{3}{c}{贝叶斯STAN-MCMC}  \\ -->
<!--   \cmidrule(r){3-5}  \cmidrule(r){6-8}  -->
<!--  \noalign{\smallskip}  -->
<!--                 &     & 估计  & 标准差 & 均方误差 & 估计  & 标准差 & 均方误差 \\  -->
<!--    \hline -->
<!--    $\beta_{0}$  & -1.0 & -5.430 & 0.562  &  1.994   & -2.060 & 0.825  & 1.805    \\  -->
<!--    $\beta_{1}$  & 1.0  & 0.942 & 0.082  &  0.110   & 1.113  & 0.311  & 0.109    \\  -->
<!--    $\beta_{2}$  & 0.5  & 0.591 & 0.039  &  0.992   & 0.563  & 0.066  & 8.463e-03     \\  -->
<!--    $\sigma^2$   & 1.0  & 0.415 & 0.264  &  0.412   & 0.830  & 0.497  & 0.276    \\  -->
<!--    $\phi$       & 1.0  & 0.514 & 0.492  &  0.478   & 0.392  & 0.223  & 0.418    \\  -->
<!--    \hline -->
<!--  \end{tabular} -->
<!-- \end{center} -->
<!-- \end{table} -->

</div>
</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-Diggle1998">
<p>Diggle, Peter J., J. A. Tawn, and R. A. Moyeed. 1998. “Model-Based Geostatistics.” <em>Journal of the Royal Statistical Society, Series C</em> 47 (3): 299–350.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="algorithms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="applications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XiangyunHuang/Thesis-Template-Bookdown/edit/master/04-simulations.Rmd",
"text": "编辑"
},
"download": ["Thesis-Template-Bookdown.pdf", "Thesis-Template-Bookdown.epub", "Thesis-Template-Bookdown.mobi"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
