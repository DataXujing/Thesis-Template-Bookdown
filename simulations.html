<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Master Thesis Template</title>
  <meta name="description" content="Spatial generalized linear mixed models, Stationary Spatial Gaussian Process, Stan platform, Markov chain Monte Carlo.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Master Thesis Template" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/logo.png" />
  <meta property="og:description" content="Spatial generalized linear mixed models, Stationary Spatial Gaussian Process, Stan platform, Markov chain Monte Carlo." />
  <meta name="github-repo" content="XiangyunHuang/Thesis-Template-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Master Thesis Template" />
  
  <meta name="twitter:description" content="Spatial generalized linear mixed models, Stationary Spatial Gaussian Process, Stan platform, Markov chain Monte Carlo." />
  <meta name="twitter:image" content="images/logo.png" />

<meta name="author" content="Xiang-Yun Huang">


<meta name="date" content="2018-10-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
<link rel="prev" href="algorithms.html">
<link rel="next" href="applications.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">空间广义线性混合效应模型及其应用</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 绪论</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivations"><i class="fa fa-check"></i><b>1.1</b> 研究意义</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#reviews"><i class="fa fa-check"></i><b>1.2</b> 文献综述</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#stracture"><i class="fa fa-check"></i><b>1.3</b> 论文结构</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#Conventions-Colophon"><i class="fa fa-check"></i><b>1.4</b> 符号说明</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prepare.html"><a href="prepare.html"><i class="fa fa-check"></i><b>2</b> 基础知识</a><ul>
<li class="chapter" data-level="2.1" data-path="prepare.html"><a href="prepare.html#sec:exp"><i class="fa fa-check"></i><b>2.1</b> 指数族</a></li>
<li class="chapter" data-level="2.2" data-path="prepare.html"><a href="prepare.html#lse"><i class="fa fa-check"></i><b>2.2</b> 最小二乘估计</a></li>
<li class="chapter" data-level="2.3" data-path="prepare.html"><a href="prepare.html#def-mle"><i class="fa fa-check"></i><b>2.3</b> 极大似然估计</a></li>
<li class="chapter" data-level="2.4" data-path="prepare.html"><a href="prepare.html#section-2.4"><i class="fa fa-check"></i><b>2.4</b> 随机过程的连续性和可微性</a></li>
<li class="chapter" data-level="2.5" data-path="prepare.html"><a href="prepare.html#stationary-gaussian-process"><i class="fa fa-check"></i><b>2.5</b> 平稳高斯过程</a></li>
<li class="chapter" data-level="2.6" data-path="prepare.html"><a href="prepare.html#Modified-Bessel-functions"><i class="fa fa-check"></i><b>2.6</b> 修正的第三类贝塞尔函数</a></li>
<li class="chapter" data-level="2.7" data-path="prepare.html"><a href="prepare.html#Laplace-approximation"><i class="fa fa-check"></i><b>2.7</b> 拉普拉斯近似</a></li>
<li class="chapter" data-level="2.8" data-path="prepare.html"><a href="prepare.html#Jeffreys-prior"><i class="fa fa-check"></i><b>2.8</b> Jeffreys 先验分布</a></li>
<li class="chapter" data-level="2.9" data-path="prepare.html"><a href="prepare.html#bayes-methods"><i class="fa fa-check"></i><b>2.9</b> 贝叶斯定理与先验分布</a></li>
<li class="chapter" data-level="2.10" data-path="prepare.html"><a href="prepare.html#Curse-of-Dimensionality"><i class="fa fa-check"></i><b>2.10</b> 维数灾难与蒙特卡罗积分</a></li>
<li class="chapter" data-level="2.11" data-path="prepare.html"><a href="prepare.html#Samplers"><i class="fa fa-check"></i><b>2.11</b> 采样器与 Stan</a></li>
<li class="chapter" data-level="2.12" data-path="prepare.html"><a href="prepare.html#sec:scale-r-hat"><i class="fa fa-check"></i><b>2.12</b> 方差缩减因子</a></li>
<li class="chapter" data-level="2.13" data-path="prepare.html"><a href="prepare.html#sec:foundations"><i class="fa fa-check"></i><b>2.13</b> 本章小结</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>3</b> 统计模型</a><ul>
<li class="chapter" data-level="3.1" data-path="models.html"><a href="models.html#Linear-Models"><i class="fa fa-check"></i><b>3.1</b> 线性模型</a></li>
<li class="chapter" data-level="3.2" data-path="models.html"><a href="models.html#Generalized-Linear-Models"><i class="fa fa-check"></i><b>3.2</b> 广义线性模型</a></li>
<li class="chapter" data-level="3.3" data-path="models.html"><a href="models.html#Generalized-Linear-Mixed-Effects-Models"><i class="fa fa-check"></i><b>3.3</b> 广义线性混合效应模型</a></li>
<li class="chapter" data-level="3.4" data-path="models.html"><a href="models.html#Spatial-Generalized-linear-mixed-effects-models"><i class="fa fa-check"></i><b>3.4</b> 空间广义线性混合效应模型</a><ul>
<li class="chapter" data-level="3.4.1" data-path="models.html"><a href="models.html#intro-sglmm"><i class="fa fa-check"></i><b>3.4.1</b> 模型结构</a></li>
<li class="chapter" data-level="3.4.2" data-path="models.html"><a href="models.html#covariance-function"><i class="fa fa-check"></i><b>3.4.2</b> 协方差函数</a></li>
<li class="chapter" data-level="3.4.3" data-path="models.html"><a href="models.html#identify"><i class="fa fa-check"></i><b>3.4.3</b> 模型识别</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="models.html"><a href="models.html#sec:models"><i class="fa fa-check"></i><b>3.5</b> 本章小结</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a><ul>
<li class="chapter" data-level="4.1" data-path="algorithms.html"><a href="algorithms.html#mle"><i class="fa fa-check"></i><b>4.1</b> 极大似然估计</a></li>
<li class="chapter" data-level="4.2" data-path="algorithms.html"><a href="algorithms.html#profile-likelihood"><i class="fa fa-check"></i><b>4.2</b> 剖面似然估计</a></li>
<li class="chapter" data-level="4.3" data-path="algorithms.html"><a href="algorithms.html#algrithms"><i class="fa fa-check"></i><b>4.3</b> 参数估计的算法</a><ul>
<li class="chapter" data-level="4.3.1" data-path="algorithms.html"><a href="algorithms.html#LA"><i class="fa fa-check"></i><b>4.3.1</b> 拉普拉斯近似算法</a></li>
<li class="chapter" data-level="4.3.2" data-path="algorithms.html"><a href="algorithms.html#MCML"><i class="fa fa-check"></i><b>4.3.2</b> 蒙特卡罗极大似然算法</a></li>
<li class="chapter" data-level="4.3.3" data-path="algorithms.html"><a href="algorithms.html#MCMC"><i class="fa fa-check"></i><b>4.3.3</b> 贝叶斯 MCMC 算法</a></li>
<li class="chapter" data-level="4.3.4" data-path="algorithms.html"><a href="algorithms.html#LowRank"><i class="fa fa-check"></i><b>4.3.4</b> 低秩近似算法</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="algorithms.html"><a href="algorithms.html#STAN-MCMC"><i class="fa fa-check"></i><b>4.4</b> 贝叶斯 STAN-MCMC 算法</a><ul>
<li class="chapter" data-level="4.4.1" data-path="algorithms.html"><a href="algorithms.html#section-4.4.1"><i class="fa fa-check"></i><b>4.4.1</b> 算法提出的背景和意义</a></li>
<li class="chapter" data-level="4.4.2" data-path="algorithms.html"><a href="algorithms.html#STANMCMC"><i class="fa fa-check"></i><b>4.4.2</b> STAN-MCMC 算法实现过程</a></li>
<li class="chapter" data-level="4.4.3" data-path="algorithms.html"><a href="algorithms.html#-r-"><i class="fa fa-check"></i><b>4.4.3</b> 求解模型的 R 包</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="algorithms.html"><a href="algorithms.html#sec:estimations"><i class="fa fa-check"></i><b>4.5</b> 本章小结</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>5</b> 数值模拟</a><ul>
<li class="chapter" data-level="5.1" data-path="simulations.html"><a href="simulations.html#spatial-gaussian-processes"><i class="fa fa-check"></i><b>5.1</b> 平稳空间高斯过程</a><ul>
<li class="chapter" data-level="5.1.1" data-path="simulations.html"><a href="simulations.html#sim-one-gp"><i class="fa fa-check"></i><b>5.1.1</b> 一维平稳空间高斯过程</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulations.html"><a href="simulations.html#sim-two-gp"><i class="fa fa-check"></i><b>5.1.2</b> 二维平稳空间高斯过程</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulations.html"><a href="simulations.html#sim-sglmm"><i class="fa fa-check"></i><b>5.2</b> 空间广义线性混合效应模型</a><ul>
<li class="chapter" data-level="5.2.1" data-path="simulations.html"><a href="simulations.html#sim-binomal-sglmm"><i class="fa fa-check"></i><b>5.2.1</b> 响应变量服从二项分布</a></li>
<li class="chapter" data-level="5.2.2" data-path="simulations.html"><a href="simulations.html#possion-sglmm"><i class="fa fa-check"></i><b>5.2.2</b> 响应变量服从泊松分布</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="simulations.html"><a href="simulations.html#sec:simulations"><i class="fa fa-check"></i><b>5.3</b> 本章小结</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>6</b> 数据分析</a><ul>
<li class="chapter" data-level="6.1" data-path="applications.html"><a href="applications.html#sptial-random-effects"><i class="fa fa-check"></i><b>6.1</b> 空间线性混合效应模型</a></li>
<li class="chapter" data-level="6.2" data-path="applications.html"><a href="applications.html#case-loaloa"><i class="fa fa-check"></i><b>6.2</b> 喀麦隆及周边地区盘尾丝虫病的空间分布</a></li>
<li class="chapter" data-level="6.3" data-path="applications.html"><a href="applications.html#case-rongelap"><i class="fa fa-check"></i><b>6.3</b> 朗格拉普岛核污染浓度的空间分布</a></li>
<li class="chapter" data-level="6.4" data-path="applications.html"><a href="applications.html#case-gambia"><i class="fa fa-check"></i><b>6.4</b> 冈比亚儿童疟疾流行强度的空间分布</a></li>
<li class="chapter" data-level="6.5" data-path="applications.html"><a href="applications.html#sec:cases"><i class="fa fa-check"></i><b>6.5</b> 本章小结</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>7</b> 总结展望</a></li>
<li class="chapter" data-level="" data-path="ack.html"><a href="ack.html"><i class="fa fa-check"></i>致谢</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>附录</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#tables-simulations"><i class="fa fa-check"></i>表格</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#simulate-code"><i class="fa fa-check"></i>代码</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#simulate-SGP-code"><i class="fa fa-check"></i>模拟平稳空间高斯过程</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#simulate-SGLMM-code"><i class="fa fa-check"></i>模拟空间广义线性模型</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#HMC-Algrithms"><i class="fa fa-check"></i>HMC 算法</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#compileinfo"><i class="fa fa-check"></i>编译信息</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#hardwareinfo"><i class="fa fa-check"></i>硬件环境</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#sysinfo"><i class="fa fa-check"></i>系统环境</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#softwareinfo"><i class="fa fa-check"></i>软件环境</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">本论文由 bookdown 强力驱动</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Master Thesis Template</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulations" class="section level1">
<h1><span class="header-section-number">第 5 章</span> 数值模拟</h1>
<p>空间广义线性混合效应模型在广义线性混合效应模型基础上添加了与空间位置相关的随机效应，这种随机效应在文献中常称为空间效应 <span class="citation">(Diggle, Tawn, and Moyeed <a href="#ref-Diggle1998">1998</a>)</span>。 它与采样点的位置、数量都有关系， 其中采样点的位置决定空间过程的协方差结构， 而采样点的数量决定空间效应的维度，从而导致空间广义线性混合效应模型比普通的广义线性混合效应模型复杂。作为过渡，我们在第 <a href="simulations.html#sim-one-gp">5.1.1</a> 和 <a href="simulations.html#sim-two-gp">5.1.2</a> 节模拟了一维和二维平稳高斯过程。 第 <a href="simulations.html#sim-sglmm">5.2</a> 节模拟 SGLMM 模型， 分两个小节展开叙述，第 <a href="simulations.html#sim-binomal-sglmm">5.2.1</a> 小节模拟响应变量服从二项分布的情形， 第 <a href="simulations.html#possion-sglmm">5.2.2</a> 小节模拟响应变量服从泊松分布的情形，在这两个小节里， 比较了蒙特卡罗极大似然算法，低秩近似算法，贝叶斯马尔科夫链蒙特卡罗算法和贝叶斯 STAN-MCMC 算法的性能差异。</p>
<p>模拟空间广义线性混合效应模型 <a href="simulations.html#eq:sim-sglmm">(5.1)</a> 分三节进行，第一节模拟空间高斯过程 <span class="math inline">\(S(x)\)</span>，第二节模拟响应变量 <span class="math inline">\(Y\)</span> 服从二项分布 ，第三节模拟响应变量 <span class="math inline">\(Y\)</span> 服从正态分布。空间高斯过程在模型 <a href="simulations.html#eq:sim-sglmm">(5.1)</a> 中作为随机效应存在，不同于一般随机效应的地方在于它与样本的空间位置有关，一般地，假定 <span class="math inline">\(S(x)\)</span> 服从 <span class="math inline">\(N\)</span> 元高斯分布 <span class="math inline">\(N(\mu_{S},G)\)</span>，<span class="math inline">\(x = (d_1,d_2) \in \mathbb{R}^2\)</span>， <span class="math inline">\(\mu_{S} = \mathbf{0}_{N\times1}\)</span>， <span class="math inline">\(G_{(ij)} = \mathrm{Cov}(S(x_i),S(x_j))=\sigma^2*\rho(u_{ij})\)</span>， <span class="math inline">\(S(x)\)</span> 的相关函数 <span class="math inline">\(\rho(u_{ij}) = \exp(-u_{ij}/\phi), u_{ij} \equiv \|x_{i}-x_{j}\|_2\)</span>，其中 <span class="math inline">\(\phi\)</span> 和 <span class="math inline">\(\sigma^2\)</span> 都是未知待估参数。可见采样点的位置 <span class="math inline">\((d_1,d_2)\)</span> 和相关函数 <span class="math inline">\(\rho(u)\)</span> 一起决定空间高斯过程的形式，并且 <span class="math inline">\(S(x)\)</span> 的维度就是采样点的数目 <span class="math inline">\(N\)</span>。这样通常导致空间效应的维度比协变量的数目大很多，模型 <a href="simulations.html#eq:sim-sglmm">(5.1)</a> 的估计问题也比一般的广义线性混合效应模型困难。</p>
<p><span class="math display" id="eq:sim-sglmm">\[\begin{equation}
g(\mu_i) = d(x_i)&#39;\beta + S(x_i) + Z_i \tag{5.1}
\end{equation}\]</span></p>
<div id="spatial-gaussian-processes" class="section level2">
<h2><span class="header-section-number">5.1</span> 平稳空间高斯过程</h2>
<div id="sim-one-gp" class="section level3">
<h3><span class="header-section-number">5.1.1</span> 一维平稳空间高斯过程</h3>
<p>一维情形下，平稳高斯过程 <span class="math inline">\(S(x)\)</span> 的协方差函数采用幂指数型，见公式 <a href="simulations.html#eq:cov-exp-quad">(5.3)</a>，当 <span class="math inline">\(\kappa =1\)</span> 时，为指数型，见公式 <a href="simulations.html#eq:cov-exp-quad">(5.3)</a>。分 <span class="math inline">\(\kappa =1\)</span> 和 <span class="math inline">\(\kappa =1\)</span>，模拟两个一维平稳空间高斯过程，协方差参数均为 <span class="math inline">\(\sigma^2 = 1\)</span>，<span class="math inline">\(\phi = 0.15\)</span>，均值向量都是 <span class="math inline">\(\mathbf{0}\)</span>，在 <span class="math inline">\([-2,2]\)</span> 的区间上，产生 2000 个服从均匀分布的随机数，由这些随机数的未知和协方差函数公式 <a href="simulations.html#eq:cov-exp">(5.2)</a> 或 <a href="simulations.html#eq:cov-exp-quad">(5.3)</a> 计算得到 2000 维的高斯分布的协方差矩阵 <span class="math inline">\(G\)</span>，为保证协方差矩阵的正定性，在矩阵对角线上添加扰动 <span class="math inline">\(1 \times 10^{-12}\)</span>，然后即可根据 Cholesky 分解该对称正定矩阵，得到下三角块 <span class="math inline">\(L\)</span>，使得 <span class="math inline">\(G = L \times L^{\top}\)</span>，再产生 2000 个服从标准正态分布的随机向量 <span class="math inline">\(\eta\)</span>，而 <span class="math inline">\(L\eta\)</span> 即为所需的服从平稳高斯过程的一组随机数。</p>
<p><span class="math display" id="eq:cov-exp-quad" id="eq:cov-exp">\[\begin{align}
\mathsf{Cov}(S(x_i), S(x_j)) &amp; = \sigma^2 \exp\big\{ - \frac{|x_{i} - x_{j}|}{ \phi } \big\}  \tag{5.2} \\
\mathsf{Cov}(S(x_i), S(x_j)) &amp; = \sigma^2 \exp\big\{ -\big( \frac{ |x_{i} - x_{j}| }{ \phi } \big) ^ {\kappa} \big\}, 0 &lt; \kappa \leq 2  \tag{5.3} 
\end{align}\]</span></p>
<div class="figure" style="text-align: center"><span id="fig:one-dim-gp"></span>
<img src="figures/one-dim-gp-exp.png" alt="模拟一维平稳空间高斯过程，协方差函数分别为指数型 (5.2) 和幂二次指数型 (5.3)，均值为 \(\mathbf{0}\)，协方差参数 \(\sigma^2 = 1\)，\(\phi = 0.15\)，横坐标表示采样的位置，纵坐标是目标值 \(S(x)\)，图中 2000 个灰色点表示服从相应随机过程的随机数，橘黄色点是从中随机选择的 36 个点。" width="70%" /><img src="figures/one-dim-gp-exp-quad.png" alt="模拟一维平稳空间高斯过程，协方差函数分别为指数型 (5.2) 和幂二次指数型 (5.3)，均值为 \(\mathbf{0}\)，协方差参数 \(\sigma^2 = 1\)，\(\phi = 0.15\)，横坐标表示采样的位置，纵坐标是目标值 \(S(x)\)，图中 2000 个灰色点表示服从相应随机过程的随机数，橘黄色点是从中随机选择的 36 个点。" width="70%" />
<p class="caption">
图 5.1: 模拟一维平稳空间高斯过程，协方差函数分别为指数型 <a href="simulations.html#eq:cov-exp">(5.2)</a> 和幂二次指数型 <a href="simulations.html#eq:cov-exp-quad">(5.3)</a>，均值为 <span class="math inline">\(\mathbf{0}\)</span>，协方差参数 <span class="math inline">\(\sigma^2 = 1\)</span>，<span class="math inline">\(\phi = 0.15\)</span>，横坐标表示采样的位置，纵坐标是目标值 <span class="math inline">\(S(x)\)</span>，图中 2000 个灰色点表示服从相应随机过程的随机数，橘黄色点是从中随机选择的 36 个点。
</p>
</div>

<p>根据定理 <a href="prepare.html#thm:stationary-mean-square-properties">2.4</a>，指数型协方差函数的平稳高斯过程在原点连续但是不可微，而幂二次指数型协方差函数在原点无穷可微，可微性越好图像上表现越光滑，对比图 <a href="simulations.html#fig:one-dim-gp">5.1</a> 的两个子图， 可以看出，在协方差参数 <span class="math inline">\(\sigma^2 = 1\)</span>，<span class="math inline">\(\phi = 0.15\)</span> 相同的情况下，<span class="math inline">\(\kappa\)</span> 越大越光滑。</p>
</div>
<div id="sim-two-gp" class="section level3">
<h3><span class="header-section-number">5.1.2</span> 二维平稳空间高斯过程</h3>
<p>二维情形下，在规则平面上模拟平稳高斯过程 <span class="math inline">\(\mathcal{S} = S(x), x \in \mathbb{R}^2\)</span>， 其均值向量为零向量 <span class="math inline">\(\mathbf{0}\)</span>， 协方差函数为指数型 (见公式 <a href="simulations.html#eq:cov-exp">(5.2)</a>) ，协方差参数 <span class="math inline">\(\phi = 1, \sigma^2 = 1\)</span>。在单位平面区域为 <span class="math inline">\([0,1] \times [0,1]\)</span> 模拟服从上述二维空间平稳高斯过程，不妨将此区域划分为 <span class="math inline">\(6 \times 6\)</span> 的小网格，而每个格点作为采样的位置，共计 36个采样点，在这些采样点上的观察值即为目标值 <span class="math inline">\(S(x)\)</span>。</p>
<p>类似本章第 <a href="simulations.html#sim-one-gp">5.1.1</a> 节模拟一维平稳空间过程的步骤， 首先根据采样点位置坐标和协方差函数 <a href="simulations.html#eq:cov-exp-quad">(5.3)</a> 计算得目标空间过程的 <span class="math inline">\(\mathcal{S}\)</span> 协方差矩阵 <span class="math inline">\(G\)</span>，然后使用 R 包 <strong>MASS</strong> 提供的 <code>mvrnorm</code> 函数产生多元正态分布随机数，与 <a href="simulations.html#sim-one-gp">5.1.1</a> 节不同的是这里采用特征值分解，即 <span class="math inline">\(G = L\Lambda L^{\top}\)</span>，与 Cholesky 分解相比，特征值分解更稳定些，但是 Cholesky 分解更快，Stan 即采用此法，后续过程与一维模拟一致。模拟获得的随机数用图 <a href="simulations.html#fig:sim-two-gp">5.2</a> 表示， 格点上的值即为平稳空间高斯过程在该点的取值 (为方便显示，已四舍五入保留两位小数)。</p>
<div class="figure" style="text-align: center"><span id="fig:sim-two-gp"></span>
<img src="04-simulations_files/figure-html/sim-two-gp-1.png" alt="模拟二维平稳空间高斯过程，自相关函数为指数形式，水平方向为横坐标，垂直方向为纵坐标，图中的橘黄色点是采样的位置，其上的数字是目标值 $S(x)$" width="45%" /><img src="04-simulations_files/figure-html/sim-two-gp-2.png" alt="模拟二维平稳空间高斯过程，自相关函数为指数形式，水平方向为横坐标，垂直方向为纵坐标，图中的橘黄色点是采样的位置，其上的数字是目标值 $S(x)$" width="45%" />
<p class="caption">
图 5.2: 模拟二维平稳空间高斯过程，自相关函数为指数形式，水平方向为横坐标，垂直方向为纵坐标，图中的橘黄色点是采样的位置，其上的数字是目标值 <span class="math inline">\(S(x)\)</span>
</p>
</div>
<p>同 <a href="simulations.html#sim-one-gp">5.1.1</a> 节，二维平稳空间高斯过程 <span class="math inline">\(S(x)\)</span> 的协方差函数也可以为更一般的梅隆型，如公式 <a href="simulations.html#eq:exp-matern">(5.4)</a> 所示。</p>
<p><span class="math display" id="eq:exp-matern">\[\begin{equation}
\rho(u) = \sigma^2 \{ 2^{\kappa -1} \Gamma(\kappa) \}^{-1}( u/\phi )^{\kappa} \mathcal{K}_{\kappa}( u / \phi ) \tag{5.4}
\end{equation}\]</span></p>
<p>且在区域 <span class="math inline">\([0,1] \times [0,1]\)</span> 上也可以随机采点，如图 <a href="simulations.html#fig:sim-two-gp">5.2</a> 的右子图所示。</p>
<p>模拟平稳空间高斯过程的其它 R 包实现方法： Paulo J. Ribeiro Jr. 和 Peter J. Diggle 开发了 <strong>geoR</strong> 包 <span class="citation">(Ribeiro Jr. and Diggle <a href="#ref-geoR2001">2001</a>)</span>，提供的 <code>grf</code> 函数除了实现 Cholesky 分解，还实现了奇异值分解，特征值分解协方差矩阵的算法。当采样点不太多时，Cholesky 分解已经足够好，下面的第 <a href="simulations.html#sim-sglmm">5.2</a> 节对平稳空间高斯过程的数值模拟即采用此法，当采样点很多，为了加快模拟的速度，可以选用 Martin Schlather 等开发的 <strong>RandomFields</strong> 包 <span class="citation">(Schlather et al. <a href="#ref-RandomFields2015">2015</a>)</span>，内置的 <code>GaussRF</code> 函数实现了用高斯马尔科夫随机场近似平稳空间高斯过程的算法，此外，Håvard Rue 等 (2009年) <span class="citation">(Rue, Martino, and Chopin <a href="#ref-Rue2009">2009</a>)</span> 也实现了从平稳高斯过程到高斯马尔科夫随机场的近似算法，开发了更为高效的 INLA 程序库 <span class="citation">(Lindgren and Rue <a href="#ref-INLA2015">2015</a>)</span>，其内置的近似程序得到了广泛的应用 <span class="citation">(Gómez-Rubio and Rue <a href="#ref-Virgilio2018">2018</a>; Marta Blangiardo <a href="#ref-Blangiardo2015">2015</a>; Xiaofeng Wang and Faraway <a href="#ref-Faraway2018">2018</a>)</span>。</p>
</div>
</div>
<div id="sim-sglmm" class="section level2">
<h2><span class="header-section-number">5.2</span> 空间广义线性混合效应模型</h2>
<div id="sim-binomal-sglmm" class="section level3">
<h3><span class="header-section-number">5.2.1</span> 响应变量服从二项分布</h3>
<p>响应变量服从二项分布 <span class="math inline">\(Y_{i} \sim \mathrm{Binomal}(m_{i},p(x_{i}))\)</span>，在位置 <span class="math inline">\(x_i\)</span> 处，以概率 <span class="math inline">\(p(x_i)\)</span> 重复抽取了 <span class="math inline">\(m_i\)</span> 个样本，总样本数 <span class="math inline">\(M=\sum_{i=1}^{N}m_i\)</span>，<span class="math inline">\(N\)</span> 是采样点的个数，二项空间广义线性混合效应模型为 <a href="simulations.html#eq:binom-SGLMM">(5.5)</a>，联系函数为 <span class="math inline">\(g(\mu_i) = \log\{\frac{p(x_i)}{1-p(x_i)}\}\)</span>，<span class="math inline">\(S(x)\)</span> 是均值为 <span class="math inline">\(\mathbf{0}\)</span>，协方差函数为 <span class="math inline">\(\mathrm{Cov}(S(x_i),S(x_j)) = \sigma^2 \big\{2^{\kappa-1}\Gamma(\kappa)\big\}^{-1}(u/\phi)^{\kappa}K_{\kappa}(u/\phi), \kappa = 0.5\)</span> 的平稳空间高斯过程。</p>
<p><span class="math display" id="eq:binom-SGLMM">\[\begin{equation}
g(\mu_i) = \log\{\frac{p(x_i)}{1-p(x_i)}\} = \alpha + S(x_i) \tag{5.5}
\end{equation}\]</span></p>
<p>固定效应参数 <span class="math inline">\(\alpha = 0\)</span>，协方差参数记为 <span class="math inline">\(\boldsymbol{\theta} = (\sigma^2, \phi) = (0.5, 0.2)\)</span>，采样点数目为 <span class="math inline">\(N = 64\)</span>，每个采样点抽取的样本数 <span class="math inline">\(m_i = 4, i = 1, 2, \ldots, 64\)</span>。首先模拟平稳空间高斯过程 <span class="math inline">\(S(x)\)</span>，在单位区域 <span class="math inline">\([0,1] \times [0,1]\)</span> 划分为 <span class="math inline">\(8 \times 8\)</span> 的网格，格点选为采样位置，用 <strong>geoR</strong> 包提供的 <code>grf</code> 函数产生协方差参数为 <span class="math inline">\(\boldsymbol{\theta} = (\sigma^2,\phi) = (0.5, 0.2)\)</span> 的平稳空间高斯过程，由公式 <a href="simulations.html#eq:binom-SGLMM">(5.5)</a> 可知 <span class="math inline">\(p(x_i) = \exp(S(x_i))/(1 + \exp(S(x_i)))\)</span>， 即每个格点处二项分布的概率值，然后依此概率，由 <code>rbinom</code> 函数产生服从二项分布的观察值 <span class="math inline">\(Y_i\)</span>，<span class="math inline">\(Y_i\)</span> 的取值范围为 <span class="math inline">\(0, 1, 2, 3, 4\)</span>，模拟的数据集可以用图 <a href="simulations.html#fig:binom-without-nugget-geoRglm">5.3</a> 直观表示。</p>
<div class="figure" style="text-align: center"><span id="fig:binom-without-nugget-geoRglm"></span>
<img src="figures/binom-without-nugget-geoRglm.png" alt="左图表示二维规则平面上的平稳空间高斯过程，格点是采样点的位置，其上的数字是 $p(x)$ 的值，已经四舍五入保留两位小数，右图表示观察值 $Y$ 随空间位置的变化，格点上的值即为观察值 $Y$，图中的两个圈分别是第1个(左下)和第29个(右上)采样点" width="90%" />
<p class="caption">
图 5.3: 左图表示二维规则平面上的平稳空间高斯过程，格点是采样点的位置，其上的数字是 <span class="math inline">\(p(x)\)</span> 的值，已经四舍五入保留两位小数，右图表示观察值 <span class="math inline">\(Y\)</span> 随空间位置的变化，格点上的值即为观察值 <span class="math inline">\(Y\)</span>，图中的两个圈分别是第1个(左下)和第29个(右上)采样点
</p>
</div>
<p>基于 Langevin-Hastings 采样器实现的马尔科夫链蒙特卡罗算法，参数 <span class="math inline">\(\alpha\)</span> 的先验分布选均值为 0，方差为 1 的标准正态分布，参数 <span class="math inline">\(\phi\)</span> 的先验分布选期望为 0.2 的指数分布，参数 <span class="math inline">\(\sigma^2\)</span> 的先验分布是非中心的逆卡方分布，其非中心化参数为 0.5，自由度为 5，各参数的先验选择来自 Ole F. Christensen 和 Peter J. Ribeiro Jr. (2002年) <span class="citation">(Christensen and Ribeiro Jr. <a href="#ref-geoRglm2002">2002</a>)</span>。Langevin-Hastings 算法运行 110000 次迭代，前 10000 次迭代用作热身 (warm-up)，后 10 万次迭代里间隔 100 次迭代采样，获得关于参数 <span class="math inline">\(\alpha,\phi,\sigma^2\)</span> 的后验分布的样本，样本量是1000。</p>
<p><span class="math display">\[\begin{align}
\alpha   &amp; \sim \mathcal{N}(0,1) \\
\phi     &amp; \sim \mathrm{Exp}(0.2) \\
\sigma^2 &amp; \sim \mathrm{Inv-}\chi^2(5,0.5)
\end{align}\]</span></p>
<table>
<caption><span id="tab:MCLH-vs-NUTS">表 5.1: </span> Langevin-Hastings 算法与汉密尔顿蒙特卡罗算法的数值模拟比较，模型参数 <span class="math inline">\(\alpha,\phi,\sigma^2\)</span> 的估计值（后验分布的均值）、方差（后验分布的方差）和 5 个分位点（后验分布的 5 个分位点），采样点数目分别考虑了 <span class="math inline">\(N = 36, 64, 81, 100\)</span> 的情况，括号内为相应参数的真值</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">true</th>
<th align="right">mean</th>
<th align="right">var</th>
<th align="right">2.5%</th>
<th align="right">25%</th>
<th align="right">50%</th>
<th align="right">75%</th>
<th align="right">97.5%</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">0.0</td>
<td align="right">-0.354</td>
<td align="right">0.079</td>
<td align="right">-0.938</td>
<td align="right">-0.524</td>
<td align="right">-0.361</td>
<td align="right">-0.173</td>
<td align="right">0.215</td>
<td align="right">36</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="right">0.2</td>
<td align="right">0.121</td>
<td align="right">0.006</td>
<td align="right">0.005</td>
<td align="right">0.055</td>
<td align="right">0.110</td>
<td align="right">0.180</td>
<td align="right">0.285</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">0.5</td>
<td align="right">0.683</td>
<td align="right">0.147</td>
<td align="right">0.215</td>
<td align="right">0.408</td>
<td align="right">0.596</td>
<td align="right">0.850</td>
<td align="right">1.667</td>
<td align="right">36</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">0.0</td>
<td align="right">0.003</td>
<td align="right">0.089</td>
<td align="right">-0.596</td>
<td align="right">-0.169</td>
<td align="right">0.013</td>
<td align="right">0.179</td>
<td align="right">0.609</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="right">0.2</td>
<td align="right">0.194</td>
<td align="right">0.004</td>
<td align="right">0.070</td>
<td align="right">0.145</td>
<td align="right">0.195</td>
<td align="right">0.250</td>
<td align="right">0.295</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">0.5</td>
<td align="right">0.656</td>
<td align="right">0.096</td>
<td align="right">0.254</td>
<td align="right">0.449</td>
<td align="right">0.592</td>
<td align="right">0.781</td>
<td align="right">1.453</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta\)</span></td>
<td align="right">0.0</td>
<td align="right">-0.155</td>
<td align="right">0.044</td>
<td align="right">-0.565</td>
<td align="right">-0.284</td>
<td align="right">-0.156</td>
<td align="right">-0.03</td>
<td align="right">0.273</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="right">0.2</td>
<td align="right">0.116</td>
<td align="right">0.006</td>
<td align="right">0.005</td>
<td align="right">0.055</td>
<td align="right">0.105</td>
<td align="right">0.17</td>
<td align="right">0.280</td>
<td align="right">81</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">0.5</td>
<td align="right">0.468</td>
<td align="right">0.057</td>
<td align="right">0.180</td>
<td align="right">0.311</td>
<td align="right">0.414</td>
<td align="right">0.56</td>
<td align="right">1.129</td>
<td align="right">81</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">0.0</td>
<td align="right">0.046</td>
<td align="right">0.251</td>
<td align="right">-0.947</td>
<td align="right">-0.269</td>
<td align="right">0.049</td>
<td align="right">0.356</td>
<td align="right">1.069</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="right">0.2</td>
<td align="right">1.042</td>
<td align="right">0.246</td>
<td align="right">0.471</td>
<td align="right">0.708</td>
<td align="right">0.921</td>
<td align="right">1.247</td>
<td align="right">2.324</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">0.5</td>
<td align="right">0.647</td>
<td align="right">0.228</td>
<td align="right">0.170</td>
<td align="right">0.338</td>
<td align="right">0.524</td>
<td align="right">0.779</td>
<td align="right">1.958</td>
<td align="right">64</td>
</tr>
</tbody>
</table>
<p>参数 <span class="math inline">\(\alpha,\phi,\sigma^2\)</span> 的贝叶斯估计没有显式表达式，通常用后验分布的均值作为参数的估计，即所谓的贝叶斯估计，它的定义就是使得估计的均方误差达到最小时的估计。贝叶斯估计 的精度或者说好坏常用后验分布的方差衡量，因为均方误差在参数估计取后验均值时就是后验方差，所以表 <a href="simulations.html#tab:MCLH-vs-NUTS">5.1</a> 不再提供估计的均方误差值，而是提供了 5 个后验分布的分位点，在 95% 的置信水平下，样本分位点 0.025 和 0.975 的值组成了置信区间的上下界。除了获得各参数的估计值外，还获得 64 个采样点处 <span class="math inline">\(p(x_i), i = 1, \ldots, 64\)</span> 的后验均值、方差、标准差和 5个分位点，详见附表 <a href="appendix.html#tab:LH-binom-SGLMM">7.1</a></p>
</div>
<div id="possion-sglmm" class="section level3">
<h3><span class="header-section-number">5.2.2</span> 响应变量服从泊松分布</h3>
<p>响应变量 <span class="math inline">\(Y\)</span> 服从泊松分布，即 <span class="math inline">\(Y_i \sim \mathrm{Possion}(\lambda(x_{i}))\)</span>，泊松空间广义线性混合效应模型 <a href="simulations.html#eq:pois-SGLMM">(5.6)</a></p>
<p><span class="math display" id="eq:pois-SGLMM">\[\begin{equation}
g(\mu_i) = \log(\lambda(x_i)) = \alpha + S(x_i) \tag{5.6}
\end{equation}\]</span></p>
<p>其中，<span class="math inline">\(S(x)\)</span> 是平稳空间高斯过程，其均值为 <span class="math inline">\(\mathbf{0}\)</span>，协方差函数为 <span class="math inline">\(\mathrm{Cov}(S(x_i),S(x_j)) = \sigma^2 \big\{2^{\kappa-1}\Gamma(\kappa)\big\}^{-1}(u/\phi)^{\kappa}K_{\kappa}(u/\phi)\)</span>，联系函数 <span class="math inline">\(g(\mu_i) = \log\{\lambda(x_{i})\}\)</span>。</p>
<p>类似 <a href="simulations.html#sim-binomal-sglmm">5.2.1</a> 小节，首先产生服从平稳空间高斯过程 <span class="math inline">\(S(x)\)</span> 的随机数 <span class="math inline">\(S(x_i),i=1,\ldots,N\)</span>，则根据 <a href="simulations.html#eq:pois-SGLMM">(5.6)</a> 式， <span class="math inline">\(\lambda(x_i) = \exp(\alpha + S(x_i))\)</span>，又响应变量 <span class="math inline">\(Y_i \sim \mathrm{Possion}(\lambda(x_{i}))\)</span>，根据 R 内置函数 <code>rpois</code> 产生服从参数为 <span class="math inline">\(\lambda(x_i)\)</span> 的泊松分布的随机数。</p>
<table>
<caption><span id="tab:Pois-MCLV-vs-NUTS">表 5.2: </span> 模型参数真值设置为 <span class="math inline">\(\alpha = 0.5, \phi = 0.2, \sigma^2 = 2.0, \kappa = 1.5\)</span>，采样点数目分别为 <span class="math inline">\(N=36,64,100\)</span></caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">true</th>
<th align="right">mean</th>
<th align="right">var</th>
<th align="right">2.5%</th>
<th align="right">25%</th>
<th align="right">50%</th>
<th align="right">75%</th>
<th align="right">97.5%</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">0.5</td>
<td align="right">0.527</td>
<td align="right">0.418</td>
<td align="right">-0.759</td>
<td align="right">0.189</td>
<td align="right">0.514</td>
<td align="right">0.855</td>
<td align="right">1.864</td>
<td align="right">36</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="right">0.2</td>
<td align="right">0.401</td>
<td align="right">0.052</td>
<td align="right">0.100</td>
<td align="right">0.240</td>
<td align="right">0.360</td>
<td align="right">0.520</td>
<td align="right">0.960</td>
<td align="right">36</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">2.0</td>
<td align="right">1.311</td>
<td align="right">0.660</td>
<td align="right">0.365</td>
<td align="right">0.766</td>
<td align="right">1.081</td>
<td align="right">1.584</td>
<td align="right">3.562</td>
<td align="right">36</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">0.5</td>
<td align="right">0.866</td>
<td align="right">1.517</td>
<td align="right">-1.610</td>
<td align="right">0.059</td>
<td align="right">0.870</td>
<td align="right">1.666</td>
<td align="right">3.159</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="right">0.2</td>
<td align="right">0.682</td>
<td align="right">0.073</td>
<td align="right">0.300</td>
<td align="right">0.480</td>
<td align="right">0.640</td>
<td align="right">0.820</td>
<td align="right">1.380</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">2.0</td>
<td align="right">3.932</td>
<td align="right">2.594</td>
<td align="right">1.667</td>
<td align="right">2.800</td>
<td align="right">3.642</td>
<td align="right">4.744</td>
<td align="right">7.740</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">0.5</td>
<td align="right">0.323</td>
<td align="right">0.657</td>
<td align="right">-1.449</td>
<td align="right">-0.124</td>
<td align="right">0.416</td>
<td align="right">0.812</td>
<td align="right">1.831</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="right">0.2</td>
<td align="right">0.617</td>
<td align="right">0.085</td>
<td align="right">0.220</td>
<td align="right">0.400</td>
<td align="right">0.560</td>
<td align="right">0.785</td>
<td align="right">1.320</td>
<td align="right">100</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">2.0</td>
<td align="right">1.479</td>
<td align="right">0.498</td>
<td align="right">0.545</td>
<td align="right">0.941</td>
<td align="right">1.352</td>
<td align="right">1.822</td>
<td align="right">3.195</td>
<td align="right">100</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\alpha\)</span></td>
<td align="right">0.5</td>
<td align="right">0.498</td>
<td align="right">0.402</td>
<td align="right">-0.775</td>
<td align="right">0.082</td>
<td align="right">0.534</td>
<td align="right">0.917</td>
<td align="right">1.798</td>
<td align="right">64</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\phi\)</span></td>
<td align="right">0.2</td>
<td align="right">0.385</td>
<td align="right">0.003</td>
<td align="right">0.285</td>
<td align="right">0.343</td>
<td align="right">0.380</td>
<td align="right">0.422</td>
<td align="right">0.509</td>
<td align="right">64</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\sigma^2\)</span></td>
<td align="right">2.0</td>
<td align="right">2.473</td>
<td align="right">0.292</td>
<td align="right">1.585</td>
<td align="right">2.102</td>
<td align="right">2.416</td>
<td align="right">2.804</td>
<td align="right">3.734</td>
<td align="right">64</td>
</tr>
</tbody>
</table>
<p>100 个采样点的模拟实验中，精心调了 Langevin-Hastings 算法的参数，得到比较好的估计值，在该组参数设置下，更改采样点数目分别为 36 和 64，得到估计值，见表 <a href="simulations.html#tab:Pois-MCLV-vs-NUTS">5.2</a>，可以看出估计值变差。</p>
<p>添加偏差 置信区间长度</p>
<p>Stan 2000 次迭代，前 1000 次迭代作为 warm-up 阶段，后 1000 次迭代全部采样</p>
<p>完整的表格见附表 <a href="appendix.html#tab:HMC-Pois-SGLMM">7.2</a></p>
</div>
</div>
<div id="sec:simulations" class="section level2">
<h2><span class="header-section-number">5.3</span> 本章小结</h2>

</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-Diggle1998">
<p>Diggle, Peter J., J. A. Tawn, and R. A. Moyeed. 1998. “Model-Based Geostatistics.” <em>Journal of the Royal Statistical Society, Series C</em> 47 (3): 299–350.</p>
</div>
<div id="ref-geoR2001">
<p>Ribeiro Jr., Paulo J., and Peter J. Diggle. 2001. “geoR: A Package for Geostatistical Analysis.” <em>R News</em> 1 (2): 14–18.</p>
</div>
<div id="ref-RandomFields2015">
<p>Schlather, Martin, Alexander Malinowski, Peter J. Menck, Marco Oesting, and Kirstin Strokorb. 2015. “Analysis, Simulation and Prediction of Multivariate Random Fields with Package RandomFields.” <em>Journal of Statistical Software</em> 63 (8): 1–25.</p>
</div>
<div id="ref-Rue2009">
<p>Rue, Håvard, Sara Martino, and Nicholas Chopin. 2009. “Approximate Bayesian Inference for Latent Gaussian Models Using Integrated Nested Laplace Approximations (with Discussion).” <em>Journal of the Royal Statistical Society, Series B</em> 71: 319–92.</p>
</div>
<div id="ref-INLA2015">
<p>Lindgren, Finn, and Håvard Rue. 2015. “Bayesian Spatial Modelling with R-INLA.” <em>Journal of Statistical Software</em> 63 (19): 1–25.</p>
</div>
<div id="ref-Virgilio2018">
<p>Gómez-Rubio, Virgilio, and Håvard Rue. 2018. “Markov Chain Monte Carlo with the Integrated Nested Laplace Approximation.” <em>Statistics and Computing</em> 28 (5): 1033–51.</p>
</div>
<div id="ref-Blangiardo2015">
<p>Marta Blangiardo, Michela Cameletti. 2015. <em>Spatial and Spatio-Temporal Bayesian Models with R-INLA</em>. Chichester, UK: John Wiley; Sons Inc.</p>
</div>
<div id="ref-Faraway2018">
<p>Xiaofeng Wang, Ryan Yue, and Julian Faraway. 2018. <em>Bayesian Regression with INLA</em>. Boca Raton, Florida: Chapman; Hall/CRC.</p>
</div>
<div id="ref-geoRglm2002">
<p>Christensen, O.F., and P.J. Ribeiro Jr. 2002. “geoRglm: A Package for Generalised Linear Spatial Models.” <em>R News</em> 2 (2): 26–28.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="algorithms.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="applications.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XiangyunHuang/Thesis-Template-Bookdown/edit/master/04-simulations.Rmd",
"text": "编辑"
},
"download": ["Thesis-Template-Bookdown.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
